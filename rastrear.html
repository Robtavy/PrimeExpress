<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>PrimeExpress ‚Äî Rastrear</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin=""/>
<style>
  body{font-family:Inter,system-ui,-apple-system,'Segoe UI',Roboto,Arial;margin:0;background:#f6f7fb;color:#111}
  header{background:#1e3799;color:#fff;padding:12px 24px;display:flex;align-items:center;justify-content:space-between}
  header img{height:40px}
  nav a{color:#fff;text-decoration:none;margin-left:16px;font-weight:600}
  .wrap{max-width:1100px;margin:28px auto;padding:0 18px}
  h1{text-align:center}
  .controls{text-align:center;margin-top:12px}
  input{padding:12px;border-radius:10px;border:1px solid #ddd;width:300px;max-width:90%}
  button{padding:10px 14px;margin-left:10px;border-radius:10px;border:none;background:#0b63b7;color:#fff;cursor:pointer}
  #map{height:320px;border-radius:12px;margin-top:18px;box-shadow:0 8px 24px rgba(11,38,73,0.06)}
  .panel{background:#fff;padding:14px;margin-top:14px;border-radius:10px;box-shadow:0 6px 18px rgba(11,38,73,0.04)}
  .muted{color:#6b7280}
  .details strong{color:#0b63b7}
  @media(max-width:720px){ .row{flex-direction:column} }
</style>
</head>
<body>
<header>
  <div style="display:flex;align-items:center;gap:12px">
    <img src="Logo.png" alt="Logo">
    <strong>PrimeExpress</strong>
  </div>
  <nav>
    <a href="index.html">Home</a>
    <a href="rastrear.html">Rastrear</a>
  </nav>
</header>

<main class="wrap">
  <h1>Rastrear pedido</h1>
  <p style="text-align:center;color:#6b7280">Digite o c√≥digo de rastreio para acompanhar sua entrega em tempo real.</p>

  <div class="controls">
    <input id="code" placeholder="Ex: PX10245BR" />
    <button onclick="startTrack()">Rastrear</button>
  </div>

  <div id="map"></div>

  <div id="info" class="panel">
    <div id="info_text" class="muted">Informe um c√≥digo de rastreio acima para come√ßar.</div>
  </div>

</main>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin=""></script>
<script>
  // Simula√ß√£o de pedidos
  const sample = {
    'PX10245BR': {
      status:'Saiu para entrega üöö',
      loc:'Avenida Paulista, S√£o Paulo - SP',
      driver:'MTR-2025A',
      eta:'18:30h (previs√£o)',
      details:`Pedido coletado no centro log√≠stico √†s 16:45h. O entregador j√° est√° a caminho da regi√£o dos Jardins. O cliente ser√° notificado por SMS 15 minutos antes da chegada.`,
      route:[[-23.5617,-46.6559],[-23.5601,-46.6600],[-23.5580,-46.6632],[-23.5562,-46.6665],[-23.5540,-46.6689]]
    },
    'PX87633RJ': {
      status:'Em rota final üèôÔ∏è',
      loc:'Copacabana, Rio de Janeiro - RJ',
      driver:'MTR-876B',
      eta:'17:45h (previs√£o)',
      details:`Pedido passou pelo t√∫nel Rebou√ßas √†s 16:55h e segue para entrega na Rua Figueiredo Magalh√£es. Ser√° necess√°ria assinatura digital no app do entregador.`,
      route:[[-22.9711,-43.1856],[-22.9695,-43.1879],[-22.9672,-43.1902],[-22.9650,-43.1921]]
    },
    'PX99112MG': {
      status:'Em confer√™ncia no centro log√≠stico üì¶',
      loc:'Pra√ßa Sete, Belo Horizonte - MG',
      driver:'MTR-991C',
      eta:'Sa√≠da prevista: 14:00h',
      details:`O pedido est√° sendo conferido e lacrado no centro log√≠stico. Assim que liberado, o motorista seguir√° para o bairro de destino.`,
      route:[[-19.9188,-43.9378],[-19.9205,-43.9350],[-19.9220,-43.9322]]
    }
  };

  // Mapa base
  let map = L.map('map', {zoomControl:true}).setView([-23.55,-46.63], 13);
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);
  let marker = L.circleMarker([-23.55,-46.63], {radius:8,color:'#0b63b7',fillColor:'#0b63b7',fillOpacity:1}).addTo(map);
  let poly = L.polyline([], {color:'#0b63b7'}).addTo(map);

  function startTrack(){
    const code = (document.getElementById('code').value || '').trim().toUpperCase();
    const infoBox = document.getElementById('info_text');

    if(!code){
      alert('Informe o c√≥digo de rastreio.');
      return;
    }

    const data = sample[code];
    if(!data){
      infoBox.innerHTML = `<p style="color:red;">‚ùå C√≥digo n√£o encontrado. Verifique e tente novamente.</p>`;
      map.setView([-23.55,-46.63], 12);
      marker.setLatLng([-23.55,-46.63]);
      poly.setLatLngs([]);
      return;
    }

    // Exibir detalhes
    infoBox.innerHTML = `
      <div class="details">
        <strong>Status:</strong> ${data.status}<br>
        <strong>Localiza√ß√£o atual:</strong> ${data.loc}<br>
        <strong>Motorista:</strong> ${data.driver}<br>
        <strong>Previs√£o:</strong> ${data.eta}<br><br>
        ${data.details}
      </div>
    `;

    // Preparar mapa
    const points = data.route;
    map.setView(points[0], 14);
    marker.setLatLng(points[0]);
    poly.setLatLngs([points[0]]);

    // Anima√ß√£o do trajeto
    if(window.__trackInterval) clearInterval(window.__trackInterval);
    let i = 0;
    window.__trackInterval = setInterval(()=>{
      i++;
      if(i >= points.length){
        clearInterval(window.__trackInterval);
        infoBox.innerHTML += `<br><br><strong>Status atualizado:</strong> Entregue ‚úÖ`;
        return;
      }
      marker.setLatLng(points[i]);
      const current = poly.getLatLngs();
      current.push(points[i]);
      poly.setLatLngs(current);
      map.panTo(points[i]);
    }, 1400);
  }
</script>
</body>
</html>
